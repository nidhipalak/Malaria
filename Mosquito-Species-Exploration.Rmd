---
title: "Mosquito Species Exploration"
author: "Murrel Pereira"
date: "11/9/2020"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(malariaAtlas)
library(leaflet)

knitr::opts_chunk$set(
  fig.width=6,
  fig.asp=.6,
  out.width ="90%"
)

theme_set(theme_minimal() +theme(legend.position = "bottom"))

options(
  ggplot2.continuous.color = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete=scale_fill_viridis_d
```

## Import

Bring in species dataset as a tibble. Instructions to bring in dataset is here: [Mapped Atlas] (https://cran.r-project.org/web/packages/malariaAtlas/vignettes/overview.html).

# One Country (Madagascar)

```{r}
MMR_vec_data <- getVecOcc(country = "Madagascar") %>% 
  as_tibble()

```

# Understand species breakdown

```{r}

MMR_vec_data %>% 
  count(species) %>% 
  arrange(desc(n)) %>% 
  knitr::kable()

MMR_vec_data %>% 
  mutate(
    species = as.factor(species),
    species = fct_infreq(species)
  ) %>% 
  ggplot(aes(x=species, fill = species)) + geom_bar() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

# How many papers is this data from?

```{r}
MMR_vec_data_paper = 
MMR_vec_data %>% 
  count(citation) %>% 
  arrange(desc(n))
```

For Madagascar dataset, there are `r nrows(MM_vec_data)` pulled from `r nrows(MM_vec_data_paper)` papers.

# Are the species spread out regionally?

```{r}

pal <- colorFactor("magma", MMR_vec_data %>% pull(species))


MMR_vec_data %>% 
  leaflet() %>% 
  addProviderTiles(providers$CartoDB.Positron) %>% 
  addCircleMarkers(~longitude, ~latitude, radius = 1, color = ~pal(species))
```


```{r}

MMR_vec_data %>% 
  leaflet() %>% 
  addTiles() %>% 
  addCircleMarkers(~longitude, ~latitude, radius = 1)
```

# Do some years have certain species occur more? (Why - climate?)